{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function AdminDashboard(){const[requests,setRequests]=useState([]);const[statusFilter,setStatusFilter]=useState('');// '' = all\nconst token=localStorage.getItem('token');// Fetch requests from backend based on status filter\nuseEffect(()=>{const fetchRequests=async()=>{try{let url='https://adicloud.onrender.com/requests';if(statusFilter){url=`https://adicloud.onrender.com/requests/status/${statusFilter}`;}const res=await axios.get(url,{headers:{Authorization:`Bearer ${token}`}});setRequests(res.data);}catch(err){console.error('Error fetching requests:',err);}};fetchRequests();},[statusFilter,token]);// Function to update request status (Approve/Reject)\nconst updateStatus=async(id,newStatus)=>{try{await axios.patch(`https://adicloud.onrender.com/requests/${id}/status`,{status:newStatus},{headers:{Authorization:`Bearer ${token}`}});// Refresh the requests list after update\nsetRequests(prev=>prev.map(req=>req._id===id?{...req,status:newStatus}:req));}catch(err){console.error('Error updating status:',err);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Admin Dashboard\"}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setStatusFilter(e.target.value),value:statusFilter,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Approved\",children:\"Approved\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Rejected\",children:\"Rejected\"})]}),/*#__PURE__*/_jsx(\"ul\",{children:requests.map(req=>{var _req$userId,_req$assetId;return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"User:\"}),\" \",(_req$userId=req.userId)===null||_req$userId===void 0?void 0:_req$userId.email,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" Asset:\"}),\" \",(_req$assetId=req.assetId)===null||_req$assetId===void 0?void 0:_req$assetId.name,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" Status:\"}),\" \",req.status,req.status==='Pending'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateStatus(req._id,'Approved'),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateStatus(req._id,'Rejected'),children:\"Reject\"})]})]},req._id);})})]});}export default AdminDashboard;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdminDashboard","requests","setRequests","statusFilter","setStatusFilter","token","localStorage","getItem","fetchRequests","url","res","get","headers","Authorization","data","err","console","error","updateStatus","id","newStatus","patch","status","prev","map","req","_id","children","onChange","e","target","value","_req$userId","_req$assetId","userId","email","assetId","name","onClick"],"sources":["C:/Adicloud/adicloud-frontend/src/pages/AdminDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nfunction AdminDashboard() {\r\n  const [requests, setRequests] = useState([]);\r\n  const [statusFilter, setStatusFilter] = useState(''); // '' = all\r\n  const token = localStorage.getItem('token');\r\n\r\n  // Fetch requests from backend based on status filter\r\n  useEffect(() => {\r\n    const fetchRequests = async () => {\r\n      try {\r\n        let url = 'https://adicloud.onrender.com/requests';\r\n        if (statusFilter) {\r\n          url = `https://adicloud.onrender.com/requests/status/${statusFilter}`;\r\n        }\r\n\r\n        const res = await axios.get(url, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n\r\n        setRequests(res.data);\r\n      } catch (err) {\r\n        console.error('Error fetching requests:', err);\r\n      }\r\n    };\r\n\r\n    fetchRequests();\r\n  }, [statusFilter, token]);\r\n\r\n  // Function to update request status (Approve/Reject)\r\n  const updateStatus = async (id, newStatus) => {\r\n    try {\r\n      await axios.patch(\r\n        `https://adicloud.onrender.com/requests/${id}/status`,\r\n        { status: newStatus },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      // Refresh the requests list after update\r\n      setRequests(prev =>\r\n        prev.map(req =>\r\n          req._id === id ? { ...req, status: newStatus } : req\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error('Error updating status:', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Admin Dashboard</h2>\r\n\r\n      {/* Status filter dropdown */}\r\n      <select onChange={(e) => setStatusFilter(e.target.value)} value={statusFilter}>\r\n        <option value=\"\">All</option>\r\n        <option value=\"Pending\">Pending</option>\r\n        <option value=\"Approved\">Approved</option>\r\n        <option value=\"Rejected\">Rejected</option>\r\n      </select>\r\n\r\n      {/* Requests list */}\r\n      <ul>\r\n        {requests.map((req) => (\r\n          <li key={req._id}>\r\n            <strong>User:</strong> {req.userId?.email} | \r\n            <strong> Asset:</strong> {req.assetId?.name} |\r\n            <strong> Status:</strong> {req.status}\r\n            {/* Show Approve/Reject buttons only if status is Pending */}\r\n            {req.status === 'Pending' && (\r\n              <>\r\n                <button onClick={() => updateStatus(req._id, 'Approved')}>Approve</button>\r\n                <button onClick={() => updateStatus(req._id, 'Rejected')}>Reject</button>\r\n              </>\r\n            )}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdminDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}