{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import RequestCard from'./components/RequestCard';import Header from'./components/Header';import'./Admindash.css';import{useParams}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function AdminDashboard(){const{status}=useParams();const[requests,setRequests]=useState([]);const[statusFilter,setStatusFilter]=useState(status||'');const token=localStorage.getItem('token');useEffect(()=>{setStatusFilter(status||'All');},[status]);useEffect(()=>{const fetchRequests=async()=>{try{let url='https://adicloud.onrender.com/requests';if(statusFilter){url=`https://adicloud.onrender.com/requests/status/${statusFilter}`;}const res=await axios.get(url,{headers:{Authorization:`Bearer ${token}`}});setRequests(res.data);}catch(err){console.error('Error fetching requests:',err);}};fetchRequests();},[statusFilter,token]);const updateStatus=async(id,newStatus)=>{try{await axios.patch(`https://adicloud.onrender.com/requests/${id}/status`,{status:newStatus},{headers:{Authorization:`Bearer ${token}`}});setRequests(prev=>prev.map(req=>req._id===id?{...req,status:newStatus}:req));}catch(err){console.error('Error updating status:',err);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{statusFilter:statusFilter,setStatusFilter:setStatusFilter}),/*#__PURE__*/_jsxs(\"div\",{className:\"body\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"View \",status||\"All\"]}),/*#__PURE__*/_jsx(\"ul\",{children:requests.map(req=>{var _req$userId,_req$assetId;return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"User:\"}),\" \",(_req$userId=req.userId)===null||_req$userId===void 0?void 0:_req$userId.email,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" Asset:\"}),\" \",(_req$assetId=req.assetId)===null||_req$assetId===void 0?void 0:_req$assetId.name,\" |\",/*#__PURE__*/_jsx(\"strong\",{children:\" Status:\"}),\" \",req.status,req.status==='Pending'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateStatus(req._id,'Approved'),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateStatus(req._id,'Rejected'),children:\"Reject\"})]})]},req._id);})})]})]});}export default AdminDashboard;","map":{"version":3,"names":["React","useEffect","useState","axios","RequestCard","Header","useParams","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdminDashboard","status","requests","setRequests","statusFilter","setStatusFilter","token","localStorage","getItem","fetchRequests","url","res","get","headers","Authorization","data","err","console","error","updateStatus","id","newStatus","patch","prev","map","req","_id","children","className","_req$userId","_req$assetId","userId","email","assetId","name","onClick"],"sources":["C:/Adicloud/adicloud-frontend/src/pages/AdminDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport RequestCard from './components/RequestCard';\r\nimport Header from './components/Header';\r\nimport './Admindash.css';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nfunction AdminDashboard() {\r\n  const { status } = useParams();\r\n  const [requests, setRequests] = useState([]);\r\n  const [statusFilter, setStatusFilter] = useState(status || '');\r\n  const token = localStorage.getItem('token');\r\n\r\n  useEffect(() => {\r\n    setStatusFilter(status || 'All');\r\n  }, [status]);\r\n\r\n  useEffect(() => {\r\n    const fetchRequests = async () => {\r\n      try {\r\n        let url = 'https://adicloud.onrender.com/requests';\r\n        if (statusFilter) {\r\n          url = `https://adicloud.onrender.com/requests/status/${statusFilter}`;\r\n        }\r\n\r\n        const res = await axios.get(url, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n\r\n        setRequests(res.data);\r\n      } catch (err) {\r\n        console.error('Error fetching requests:', err);\r\n      }\r\n    };\r\n\r\n    fetchRequests();\r\n  }, [statusFilter, token]);\r\n\r\n  const updateStatus = async (id, newStatus) => {\r\n    try {\r\n      await axios.patch(\r\n        `https://adicloud.onrender.com/requests/${id}/status`,\r\n        { status: newStatus },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setRequests(prev =>\r\n        prev.map(req =>\r\n          req._id === id ? { ...req, status: newStatus } : req\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error('Error updating status:', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Header statusFilter={statusFilter} setStatusFilter={setStatusFilter} />\r\n      <div className='body'>\r\n        <h1>View {status || \"All\"}</h1>\r\n        <ul>\r\n          {requests.map((req) => (\r\n            <li key={req._id}>\r\n              <strong>User:</strong> {req.userId?.email} | \r\n              <strong> Asset:</strong> {req.assetId?.name} |\r\n              <strong> Status:</strong> {req.status}\r\n              {req.status === 'Pending' && (\r\n                <>\r\n                  <button onClick={() => updateStatus(req._id, 'Approved')}>Approve</button>\r\n                  <button onClick={() => updateStatus(req._id, 'Rejected')}>Reject</button>\r\n                </>\r\n              )}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdminDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}